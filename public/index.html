<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Issue 27: Prevent iOS zoom with proper viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <title>TES Property - Find Your Dream Home</title>
  
  <!-- PWA Meta Tags (Issue 24) -->
  <meta name="description" content="Browse quality properties in Metro Manila and nearby areas. Real Estate Inquiry Management System.">
  <meta name="theme-color" content="#2563eb">
  <link rel="manifest" href="/manifest.json">
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" href="/assets/icon-192x192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="TES Property">
  
  <!-- Issue 20: Skip to content link for keyboard navigation -->
  <a href="#main-content" class="sr-only skip-link">Skip to main content</a>
  
  <script type="module" src="/src/main.ts"></script>
</head>
<body x-data="propertyBrowser()">
  <!-- Navigation -->
  <nav class="navbar sticky top-0 z-50">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between py-4">
        <a href="/index.html" class="navbar-brand">üè† TES Property</a>
        
        <!-- Mobile menu button -->
        <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden touch-target">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        
        <!-- Desktop menu -->
        <ul class="hidden md:flex items-center space-x-6">
          <li><a href="/index.html" class="hover:text-primary-600">Properties</a></li>
          <li><a href="/how-to-inquire.html" class="hover:text-primary-600">How to Inquire</a></li>
          <li><a href="#contact" class="hover:text-primary-600">Contact</a></li>
          <li><a href="/shared/login.html" class="btn btn-primary btn-sm">Login</a></li>
        </ul>
        
        <!-- Mobile menu -->
        <div x-show="mobileMenuOpen" 
             x-transition
             @click.outside="mobileMenuOpen = false"
             class="absolute top-16 left-0 right-0 bg-white shadow-lg md:hidden">
          <ul class="flex flex-col p-4 space-y-2">
            <li><a href="/index.html" class="block py-2">Properties</a></li>
            <li><a href="/how-to-inquire.html" class="block py-2">How to Inquire</a></li>
            <li><a href="#contact" class="block py-2">Contact</a></li>
            <li><a href="/shared/login.html" class="btn btn-primary btn-sm w-full">Login</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  
  <!-- Hero Section -->
  <section class="bg-gradient-to-r from-primary-600 to-primary-800 text-white py-20" role="banner">
    <div class="container mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Find Your Dream Home</h1>
      <p class="text-xl md:text-2xl opacity-90">Browse quality properties in Metro Manila and nearby areas</p>
    </div>
  </section>
  
  <!-- Main Content (Issue 20) -->
  <main id="main-content">
  
  <!-- Filters -->
  <section class="container mx-auto px-4 py-8" aria-label="Property filters">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <!-- Issue 20, 21: Keyboard navigation and ARIA labels -->
      <div class="form-group mb-0">
        <label for="filterPrice" class="form-label">Price Range</label>
        <select 
          id="filterPrice" 
          x-model="filters.price" 
          @change="applyFilters()" 
          class="form-select"
          aria-label="Filter by price range"
          tabindex="0">
          <option value="">All Prices</option>
          <option value="0-1000000">Under ‚Ç±1M</option>
          <option value="1000000-3000000">‚Ç±1M - ‚Ç±3M</option>
          <option value="3000000-5000000">‚Ç±3M - ‚Ç±5M</option>
          <option value="5000000-10000000">‚Ç±5M - ‚Ç±10M</option>
          <option value="10000000-999999999">Above ‚Ç±10M</option>
        </select>
      </div>
      
      <div class="form-group mb-0">
        <label for="filterType" class="form-label">Property Type</label>
        <select id="filterType" x-model="filters.type" @change="applyFilters()" class="form-select">
          <option value="">All Types</option>
          <option value="House">House</option>
          <option value="Condo">Condo</option>
          <option value="Townhouse">Townhouse</option>
          <option value="Lot">Lot</option>
          <option value="Commercial">Commercial</option>
        </select>
      </div>
      
      <div class="form-group mb-0">
        <label for="filterLocation" class="form-label">Location</label>
        <select id="filterLocation" x-model="filters.location" @change="applyFilters()" class="form-select">
          <option value="">All Locations</option>
          <option value="Makati">Makati</option>
          <option value="Taguig">Taguig / BGC</option>
          <option value="Quezon City">Quezon City</option>
          <option value="Pasig">Pasig</option>
          <option value="Manila">Manila</option>
          <option value="Cavite">Cavite</option>
          <option value="Batangas">Batangas</option>
        </select>
      </div>
      
      <div class="form-group mb-0">
        <label for="filterStatus" class="form-label">Status</label>
        <select id="filterStatus" x-model="filters.status" @change="applyFilters()" class="form-select">
          <option value="">All Status</option>
          <option value="Available">Available</option>
          <option value="Reserved">Reserved</option>
          <option value="Pending">Pending</option>
        </select>
      </div>
    </div>
  </section>
  
  <!-- Issue 4: Refresh Controls -->
  <section class="container mx-auto px-4 pb-4">
    <div class="refresh-controls">
      <button 
        @click="manualRefresh()" 
        :disabled="isRefreshing"
        :class="{ 'btn-loading': isRefreshing }"
        class="btn btn-secondary btn-sm touch-target"
        aria-label="Refresh properties">
        <span x-show="!isRefreshing">üîÑ Refresh</span>
        <span x-show="isRefreshing">Refreshing...</span>
      </button>
      <span class="last-refresh-time" aria-live="polite">
        Last updated: <span x-text="lastRefreshTime"></span>
      </span>
    </div>
  </section>

  <!-- Properties Grid -->
  <section class="container mx-auto px-4 pb-16" aria-label="Property listings">
    <!-- Loading state (Issue 10) -->
    <div x-show="loading" class="text-center py-12" role="status" aria-live="polite">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto" aria-hidden="true"></div>
      <p class="mt-4 text-gray-600">Loading properties...</p>
    </div>
    
    <!-- Properties (Issue 17, 18, 19) -->
    <div x-show="!loading && paginatedProperties.length > 0" 
         class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
         role="list">
      <template x-for="property in paginatedProperties" :key="property.id">
        <article class="card overflow-hidden" role="listitem" :data-property-id="property.id">
          <!-- Issue 18: Lazy load images -->
          <img 
            :src="getFirstPhoto(property)" 
            :alt="property.name + ' - Property photo'" 
            class="w-full h-48 object-cover" 
            loading="lazy">
          <div class="p-4">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-xl font-semibold" x-text="property.name"></h3>
              <!-- Issue 22: Status badge with icon -->
              <span 
                :class="'status-badge status-badge-' + property.status.toLowerCase()" 
                role="status"
                :aria-label="'Property status: ' + property.status">
                <svg class="status-icon" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                  <circle cx="10" cy="10" r="6" />
                </svg>
                <span x-text="property.status"></span>
              </span>
            </div>
            <p class="text-gray-600 text-sm mb-2" x-text="property.address.city + ', ' + property.address.province"></p>
            <p class="text-2xl font-bold text-primary-600 mb-2" x-text="formatPHP(property.price)"></p>
            <p class="text-gray-700 mb-4 line-clamp-2" x-text="property.description"></p>
            <div class="flex flex-wrap gap-2 mb-4">
              <template x-for="feature in property.features.slice(0, 3)" :key="feature">
                <span class="text-xs bg-gray-100 px-2 py-1 rounded" x-text="feature"></span>
              </template>
            </div>
            <a 
              :href="'/property-details.html?id=' + property.id" 
              class="btn btn-primary w-full touch-target"
              :aria-label="'View details for ' + property.name">
              View Details
            </a>
          </div>
        </article>
      </template>
    </div>
    
    <!-- Issue 17: Pagination -->
    <div x-show="!loading && paginatedProperties.length > 0" class="pagination" role="navigation" aria-label="Pagination">
      <button 
        @click="previousPage()" 
        :disabled="currentPage === 1"
        class="pagination-btn touch-target"
        aria-label="Previous page">
        ‚Üê Previous
      </button>
      
      <span class="pagination-info" aria-live="polite">
        Page <span x-text="currentPage"></span> of <span x-text="totalPages"></span>
        (<span x-text="filteredProperties.length"></span> properties)
      </span>
      
      <button 
        @click="nextPage()" 
        :disabled="currentPage === totalPages"
        class="pagination-btn touch-target"
        aria-label="Next page">
        Next ‚Üí
      </button>
    </div>
    
    <!-- No properties -->
    <div x-show="!loading && filteredProperties.length === 0" 
         class="text-center py-12"
         role="status"
         aria-live="polite">
      <h3 class="text-2xl font-semibold mb-2">No properties found</h3>
      <p class="text-gray-600">Try adjusting your filters</p>
    </div>
  </section>
  
  </main>
  
  <!-- Contact Section -->
  <section id="contact" class="bg-white py-16">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl font-bold text-center mb-12">Contact Us</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
        <div>
          <div class="text-4xl mb-4">üìû</div>
          <h3 class="text-xl font-semibold mb-2">Phone</h3>
          <p class="text-gray-600">0917-000-0000</p>
        </div>
        <div>
          <div class="text-4xl mb-4">üìß</div>
          <h3 class="text-xl font-semibold mb-2">Email</h3>
          <p class="text-gray-600">info@tesproperty.com</p>
        </div>
        <div>
          <div class="text-4xl mb-4">üïê</div>
          <h3 class="text-xl font-semibold mb-2">Business Hours</h3>
          <p class="text-gray-600">8 AM - 10 PM Daily</p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-8">
    <div class="container mx-auto px-4 text-center">
      <p>&copy; 2025 TES Property. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>
